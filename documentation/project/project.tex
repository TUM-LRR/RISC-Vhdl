\Chapter{Projektablauf}

\Section{Aufgabe}

Die Aufgabe bestand darin, einen funktionsf\"ahigen Prozessor auf Basis der RISC-V Instruction Set Architecture zu entwickeln, der auf dem FPGA des gegebenen Entwicklungsboards (\Externalname{Spartan-3A FPGA Starter Kit}) l\"auft.
\begin{figure}[H]
	\centering
		\includegraphics[width=0.3\textwidth]{Board.png}
	\caption[Entwicklungsboard]{Das verwendete Entwicklungsboard von oben, der FPGA liegt zentral}
	\label{fig:board}
\end{figure}
\Section{Basisziele}


Als Mindestanforderung sollte ein Prozessor mit Kompatibilit\"at zur \Externalname{RV32I Base Integer Instruction Set} implementiert werden. Ausgenommen davon sind die Befehle FENCE, FENCE.I, SCALL und SBREAK, da keine Hardwareunterst\"utzung f\"ur den Multitaskingbetrieb bereitgestellt werden soll.

Um die Funktionsf\"ahigkeit des Prozessors auch nach au{\ss}en sichtbar zu machen und keine Black-Box zu erstellen soll die M\"oglichkeit der Interaktion \"uber die Schnittstellen und Pins des Boards bestehen. Insbesondere soll zum Debugging eine grafische Registerausgabe \"uber den VGA-Port an einem Monitor m\"oglich sein.\footnote{Siehe dazu auch Pflichtenhefte vom 02.06.16 bzw. 12.11.16}

\Section{Erweiterungsziele}

Aufgrund der Modularit\"at von RISC-V bietet es sich an die Erweiterung \Externalname{RV32M Standard Extension for Integer Multiplication and Division} zu implementieren, welche Multiplikations- und Divisionsbefehle beinhaltet. Zudem soll die rudiment\"are Ausgabe um einen Textmodus erweitert werden, sodass mittels Memory-Mapping ASCII-Zeichen auf dem Monitor ausgegeben werden k\"onnen. Zum Demonstrieren der Funktionalit\"at soll au{\ss}erdem ein auf dem Prozessor lauff\"ahiges Spiel entwickelt werden. Um auch Daten\"ubertragung mit der Au{\ss}enwelt zu erm\"oglichen soll die serielle Schnittstelle genutzt werden.

\Section{Projektablauf}
\Subsection{Zeitlicher Verlauf}
W\"ahrend den zwei Semestern Praktikumsdauer wurden insgesamt drei Versionen
des Prozessors gebaut:

\begin{table}[H]
\begin{tabular}{|p{50pt}|p{80pt}|p{220pt}|p{110pt}|}
\hline
Version & Zeitraum                                   & Ziele                                                                            & davon nicht erreicht                          \\
\hline
1       & \mbox{April 2016 -} \mbox{Juni 2016}       & \begin{itemize}[noitemsep,topsep=0pt]
                                                       \item Pr\"ufung der Strukturierung des Prozessors in ALU, Leitwerk und MMU
                                                       \item Pr\"ufung der Arbeitsaufteilung
                                                       \item Verst\"andnis der Tools
                                                       \item Ausf\"uhrung einiger einfacher Befehle
                                                       \end{itemize}                                                                    &                                               \\
\hline
2       & \mbox{Juni 2016 -} \mbox{September 2016}   & \begin{itemize}[noitemsep,topsep=0pt]
                                                       \item Implementierung der RV32I-Spezifikation
                                                       \item Lese- und Schreibzugriff auf den DDR2-RAM
                                                       \item Debugging-Ausgabe
                                                       \end{itemize}                                                                    & Lese- und Schreibzugriff auf den DDR2-RAM     \\
\hline
3       & \mbox{September 2016 -} \mbox{Januar 2017} & \begin{itemize}[noitemsep,topsep=0pt]
                                                       \item Implementierung der RV32M-Spezifikation
                                                       \item Lese- und Schreibzugriff auf den DDR2-RAM
                                                       \item ASCII-Ausgabe
                                                       \item Zugriff auf Buttons, LEDS, \dots{} des Boards durch Memory-Mapped-I/O
                                                       \item serielle Schnittstelle (UART)
                                                       \end{itemize}                                                                    & serielle Schnittstelle (nur teilweise)        \\
\hline
\end{tabular}
\caption{\"Ubersicht \"uber den Projektablauf}
\end{table}

Da die Aufteilung eines Prozessors in Leitwerk, ALU und MMU nahe lag, wurde
f\"ur jede dieser Einheiten durchg\"angig eine Kleingruppe verantwortlich
gemacht. Dennoch wurde entschieden, dass ein Treffen pro Woche sinnvoll zum
Testen und Integrieren der einzelnen Einheiten ist. Es hat sich jedoch
herausgestellt, dass bei diesen Treffen meistens nur die Gruppen zweier
Einheiten ??????????????????

\Section{Verwendete Tools}
Das Projekt wurde in VHDL implementiert, da s\"amtliche Programmierer ausschlie{\ss}lich in dieser Hardwarebeschreibungssprache gute Kenntnisse hatten.\\
Zur Entwicklung wurde haupts\"achlich Xilinx' \Externalname{ISE Project Navigator} in Version 14.7 verwendet. Dieser diente zugleich als Editor f\"ur den VHDL-Code und auch als Werkzeug um daraus die Programming-Files, mit welchen das FPGA beschrieben wird, zu generieren. Der integrierte \Externalname{Core Generator} wurde dabei benutzt um einzelne Module zu erstellen.\\
\begin{figure}[H]
	\centering
		\includegraphics[width=1.0\textwidth]{ISE.png}
	\caption[\Externalname{ISE Project Navigator}]{Der Xilinx \Externalname{ISE Project Navigator}}
	\label{fig:tool}
\end{figure}
Mittels Xilinx' \Externalname{impact} in Kombination mit dem \Externalname{Cable-Server} wurde das Board dann \"uber USB gem\"a{\ss} den Programming-Files beschrieben.\\
Zur Versionsverwaltung wurde dabei auf ein \Externalname{Github Repository} gesetzt.\\ 
Um nicht jedes zu testende Programm per Hand assemblieren zu m\"ussen wurde ein Assemblierer auf \Externalname{Python}-Basis erstellt.\\
Da die Generierung eines Programming-Files mit anschlie{\ss}endem Beschreiben des FPGAs selbst dann noch jedes Mal mehrere Minuten in Anspruch nimmt, wurden zum schnelleren Testen Simulatoren verwendet. Um den VHDL-Code zu verifizieren wurde so \Externalname{GHDL} in Kombination mit \Externalname{GTKWave} verwendet. Auch zur Assemblerprogrammierung wurde ein Simulator mitsamt Textausgabe entwickelt um schneller debuggen zu k\"onnen.
